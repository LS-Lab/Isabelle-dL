%
\begin{isabellebody}%
\setisabellecontext{Finite{\isacharunderscore}String}%
%
\begin{isamarkuptext}%
Finite-String.thy implements a type of strings whose lengths are bounded by a constant defined 
    at "proof-time", by taking a sub-type of the built-in string type. A finite length bound is
    important for applications in real analysis, specifically the Differential-Dynamic-Logic (dL) 
    entry, because finite-string identifiers are used as the index of a real vector, only forming a
    Euclidean space if identifiers are finite.

    We include finite strings in this AFP entry both to promote using it as the basis of future
    versions of the dL entry and simply in case the typeclass instances herein are useful. One could
    imagine using this type in file formats with fixed-length fields.

    Author:     Brandon Bohrer%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ {\isachardoublequoteopen}Finite{\isacharunderscore}String{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{imports}\ \isanewline
\ \ \ \ Main\ \isanewline
\ \ \ \ {\isachardoublequoteopen}HOL{\isacharminus}Library{\isachardot}Code{\isacharunderscore}Target{\isacharunderscore}Int{\isachardoublequoteclose}\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
This theory uses induction on pairs of lists often: give names to the cases%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemmas}\isamarkupfalse%
\ list{\isacharunderscore}induct{\isadigit{2}}{\isacharprime}{\isacharbrackleft}case{\isacharunderscore}names\ BothNil\ LeftCons\ RightCons\ BothCons{\isacharbrackright}\ {\isacharequal}\ List{\isachardot}list{\isacharunderscore}induct{\isadigit{2}}{\isacharprime}%
\begin{isamarkuptext}%
Set a hard-coded global maximum string length%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ max{\isacharunderscore}str{\isacharcolon}{\isachardoublequoteopen}MAX{\isacharunderscore}STR\ {\isacharequal}\ {\isadigit{2}}{\isadigit{0}}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Finite strings are strings whose size is within the maximum%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{typedef}\isamarkupfalse%
\ fin{\isacharunderscore}string\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharbraceleft}s{\isacharcolon}{\isacharcolon}string{\isachardot}\ size\ s\ {\isasymle}\ MAX{\isacharunderscore}STR{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{morphisms}\ Rep{\isacharunderscore}fin{\isacharunderscore}string\ Abs{\isacharunderscore}fin{\isacharunderscore}string\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ exI{\isacharbrackleft}\isakeyword{where}\ x{\isacharequal}Nil{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ max{\isacharunderscore}str{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Lift definition of string length%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{setup{\isacharunderscore}lifting}\isamarkupfalse%
\ \ Finite{\isacharunderscore}String{\isachardot}fin{\isacharunderscore}string{\isachardot}type{\isacharunderscore}definition{\isacharunderscore}fin{\isacharunderscore}string\ \isanewline
\isacommand{lift{\isacharunderscore}definition}\isamarkupfalse%
\ ilength{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}fin{\isacharunderscore}string\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{is}\ length%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Product of types never decreases cardinality%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}prod{\isacharunderscore}finite{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ C{\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}char\ set{\isachardoublequoteclose}\ \isakeyword{and}\ S{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}string\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ C{\isacharcolon}{\isachardoublequoteopen}card\ C\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{and}\ S{\isacharcolon}{\isachardoublequoteopen}card\ S\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}card\ C\ {\isacharasterisk}\ card\ S\ {\isasymge}\ card\ S{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ C\ S\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{fun}\isamarkupfalse%
\ cons\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharprime}a\ {\isacharasterisk}\ {\isacharprime}a\ list{\isacharparenright}\ {\isasymRightarrow}\ {\isacharprime}a\ list{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}cons\ {\isacharparenleft}x{\isacharcomma}y{\isacharparenright}\ {\isacharequal}\ x\ {\isacharhash}\ y{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Finite strings are finite%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{instantiation}\isamarkupfalse%
\ fin{\isacharunderscore}string\ {\isacharcolon}{\isacharcolon}\ finite\ \isakeyword{begin}\isanewline
\isacommand{instance}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ any{\isacharcolon}{\isachardoublequoteopen}{\isasymforall}i{\isacharcolon}{\isacharcolon}nat{\isachardot}\ card\ {\isacharbraceleft}s{\isacharcolon}{\isacharcolon}string{\isachardot}\ length\ s\ {\isasymle}\ i{\isacharbraceright}\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto{\isacharparenright}\isanewline
\ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ i\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induct\ i{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Suc\ k{\isacharparenright}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ IH{\isacharcolon}{\isachardoublequoteopen}card\ {\isacharbraceleft}s{\isacharcolon}{\isacharcolon}string{\isachardot}\ length\ s\ {\isasymle}\ k{\isacharbraceright}\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}c\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharparenleft}UNIV{\isacharcolon}{\isacharcolon}char\ set{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}ih\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharbraceleft}s{\isacharcolon}{\isacharcolon}string{\isachardot}\ length\ s\ {\isasymle}\ k{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}prod\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharquery}c\ {\isasymtimes}\ {\isacharquery}ih{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}b\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharparenleft}cons\ {\isacharbackquote}\ {\isacharquery}prod{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}A\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharbraceleft}s{\isacharcolon}{\isacharcolon}string{\isachardot}\ length\ s\ {\isasymle}\ Suc\ k{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}B\ {\isacharequal}\ {\isachardoublequoteopen}insert\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharquery}b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ IHfin{\isacharcolon}{\isachardoublequoteopen}finite\ {\isacharquery}ih{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ IH\ card{\isacharunderscore}ge{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}finite\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ finChar{\isacharcolon}{\isachardoublequoteopen}finite\ {\isacharquery}c{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}ge{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}finite\ finite{\isacharunderscore}code\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ finiteProd{\isacharcolon}{\isachardoublequoteopen}finite\ {\isacharquery}prod{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Groups{\isacharunderscore}Big{\isachardot}card{\isacharunderscore}cartesian{\isacharunderscore}product\ IHfin\ finChar\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ cardCons{\isacharcolon}{\isachardoublequoteopen}card\ {\isacharquery}b\ {\isacharequal}\ card\ {\isacharquery}prod{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ Finite{\isacharunderscore}Set{\isachardot}card{\isacharunderscore}image{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ inj{\isacharunderscore}on{\isacharunderscore}def{\isacharparenright}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ finiteCons{\isacharcolon}{\isachardoublequoteopen}finite\ {\isacharquery}b{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ cardCons\ finiteProd\ card{\isacharunderscore}ge{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}finite\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ finiteB{\isacharcolon}{\isachardoublequoteopen}finite\ {\isacharquery}B{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}insert\ finiteCons\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ lr{\isacharcolon}{\isachardoublequoteopen}{\isasymAnd}x{\isachardot}\ x\ {\isasymin}\ {\isacharquery}A\ {\isasymLongrightarrow}\ x\ {\isasymin}\ {\isacharquery}B{\isachardoublequoteclose}\ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ x\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto{\isacharparenright}\ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ x{\isacharparenright}\ \isacommand{apply}\isamarkupfalse%
\ auto\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ UNIV{\isacharunderscore}I\ cons{\isachardot}simps\ image{\isacharunderscore}eqI\ mem{\isacharunderscore}Collect{\isacharunderscore}eq\ mem{\isacharunderscore}Sigma{\isacharunderscore}iff{\isacharparenright}\ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ rl{\isacharcolon}{\isachardoublequoteopen}{\isasymAnd}x{\isachardot}\ x\ {\isasymin}\ {\isacharquery}B\ {\isasymLongrightarrow}\ x\ {\isasymin}\ {\isacharquery}A{\isachardoublequoteclose}\ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ x\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto{\isacharparenright}\ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ isCons{\isacharcolon}{\isachardoublequoteopen}{\isacharquery}A\ {\isacharequal}\ {\isacharquery}B{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ lr\ rl\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ finiteB\ isCons\ IH\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ card{\isacharunderscore}insert{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{done}\isamarkupfalse%
\ \isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ finMax\ {\isacharequal}\ card{\isacharunderscore}ge{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}finite{\isacharbrackleft}OF\ spec{\isacharbrackleft}OF\ any{\isacharcomma}\ of\ MAX{\isacharunderscore}STR{\isacharbrackright}{\isacharbrackright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharcolon}{\isachardoublequoteopen}finite\ {\isacharbraceleft}x\ {\isacharbar}\ x\ y\ {\isachardot}\ x\ {\isacharequal}\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ y\ {\isasymand}\ y\ {\isasymin}\ {\isacharbraceleft}s{\isachardot}\ length\ s\ {\isasymle}\ MAX{\isacharunderscore}STR{\isacharbraceright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}cases\ finMax\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ univEq{\isacharcolon}{\isachardoublequoteopen}UNIV\ {\isacharequal}\ {\isacharbraceleft}x\ {\isacharbar}\ x\ y\ {\isachardot}\ x\ {\isacharequal}\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ y\ {\isasymand}\ y\ {\isasymin}\ {\isacharbraceleft}s{\isachardot}\ length\ s\ {\isasymle}\ MAX{\isacharunderscore}STR{\isacharbraceright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}cases\ \ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}\ Collect{\isacharunderscore}cong\ UNIV{\isacharunderscore}I\ top{\isacharunderscore}empty{\isacharunderscore}eq\ top{\isacharunderscore}set{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharparenleft}UNIV\ {\isacharcolon}{\isacharcolon}\ fin{\isacharunderscore}string\ set{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ univEq\ fin\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharparenleft}UNIV{\isacharcolon}{\isacharcolon}fin{\isacharunderscore}string\ set{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
%
\begin{isamarkuptext}%
Characters are linearly ordered by their code value%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{instantiation}\isamarkupfalse%
\ char\ {\isacharcolon}{\isacharcolon}\ linorder\ \isakeyword{begin}\isanewline
\isacommand{definition}\isamarkupfalse%
\ less{\isacharunderscore}eq{\isacharunderscore}char\ \isakeyword{where}\isanewline
less{\isacharunderscore}eq{\isacharunderscore}char{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}{\isachardoublequoteopen}less{\isacharunderscore}eq{\isacharunderscore}char\ x\ \ y\ {\isasymequiv}\ int{\isacharunderscore}of{\isacharunderscore}char\ x\ {\isasymle}\ int{\isacharunderscore}of{\isacharunderscore}char\ y{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ less{\isacharunderscore}char\ \isakeyword{where}\isanewline
less{\isacharunderscore}char{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}{\isachardoublequoteopen}less{\isacharunderscore}char\ x\ y\ {\isasymequiv}\ int{\isacharunderscore}of{\isacharunderscore}char\ x\ {\isacharless}\ int{\isacharunderscore}of{\isacharunderscore}char\ y{\isachardoublequoteclose}\isanewline
\isacommand{instance}\isamarkupfalse%
\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
{\isacharparenleft}standard{\isacharcomma}\ auto\ simp\ add{\isacharcolon}\ less{\isacharunderscore}char\ less{\isacharunderscore}eq{\isacharunderscore}char\ int{\isacharunderscore}of{\isacharunderscore}char{\isacharunderscore}def{\isacharparenright}{\isacharplus}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{end}\isamarkupfalse%
%
\begin{isamarkuptext}%
Finite strings are linearly ordered, lexicographically%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{instantiation}\isamarkupfalse%
\ fin{\isacharunderscore}string\ {\isacharcolon}{\isacharcolon}\ linorder\ \isakeyword{begin}\isanewline
\isacommand{fun}\isamarkupfalse%
\ lleq{\isacharunderscore}charlist\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}char\ list\ {\isasymRightarrow}\ char\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}lleq{\isacharunderscore}charlist\ Nil\ Nil\ {\isacharequal}\ True{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}lleq{\isacharunderscore}charlist\ Nil\ {\isacharunderscore}\ {\isacharequal}\ True{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}lleq{\isacharunderscore}charlist\ {\isacharunderscore}\ Nil\ {\isacharequal}\ False{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}lleq{\isacharunderscore}charlist\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isacharparenleft}y\ {\isacharhash}\ ys{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ {\isacharparenleft}if\ x\ {\isacharequal}\ y\ then\ lleq{\isacharunderscore}charlist\ xs\ ys\ else\ x\ {\isacharless}\ y{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ less{\isacharunderscore}charlist\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}char\ list\ {\isasymRightarrow}\ char\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}less{\isacharunderscore}charlist\ Nil\ Nil\ {\isacharequal}\ False{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}less{\isacharunderscore}charlist\ Nil\ {\isacharunderscore}\ {\isacharequal}\ True{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}less{\isacharunderscore}charlist\ {\isacharunderscore}\ Nil\ {\isacharequal}\ False{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}less{\isacharunderscore}charlist\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isacharparenleft}y\ {\isacharhash}\ ys{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ {\isacharparenleft}if\ x\ {\isacharequal}\ y\ then\ less{\isacharunderscore}charlist\ xs\ ys\ else\ x\ {\isacharless}\ y{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lift{\isacharunderscore}definition}\isamarkupfalse%
\ less{\isacharunderscore}eq{\isacharunderscore}fin{\isacharunderscore}string{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}fin{\isacharunderscore}string\ {\isasymRightarrow}\ fin{\isacharunderscore}string\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{is}\ lleq{\isacharunderscore}charlist%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isacommand{lift{\isacharunderscore}definition}\isamarkupfalse%
\ less{\isacharunderscore}fin{\isacharunderscore}string{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}fin{\isacharunderscore}string\ {\isasymRightarrow}\ fin{\isacharunderscore}string\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{is}\ less{\isacharunderscore}charlist%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lleq{\isacharunderscore}head{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ L{\isadigit{1}}\ L{\isadigit{2}}\ x\isanewline
\ \ \isakeyword{assumes}\ a{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\isasymAnd}z{\isachardot}\ lleq{\isacharunderscore}charlist\ L{\isadigit{2}}\ z\ {\isasymLongrightarrow}\ lleq{\isacharunderscore}charlist\ L{\isadigit{1}}\ z{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}lleq{\isacharunderscore}charlist\ L{\isadigit{1}}\ L{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}lleq{\isacharunderscore}charlist\ {\isacharparenleft}x\ {\isacharhash}\ L{\isadigit{2}}{\isacharparenright}\ w{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}lleq{\isacharunderscore}charlist\ {\isacharparenleft}x\ {\isacharhash}\ L{\isadigit{1}}{\isacharparenright}\ w{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ a\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}induction\ arbitrary{\isacharcolon}\ x\ rule{\isacharcolon}\ List{\isachardot}list{\isacharunderscore}induct{\isadigit{2}}{\isacharprime}{\isacharcomma}\ auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lleq{\isacharunderscore}less{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ x\ y\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}less{\isacharunderscore}charlist\ x\ y{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}lleq{\isacharunderscore}charlist\ x\ y\ {\isasymand}\ {\isasymnot}\ lleq{\isacharunderscore}charlist\ y\ \ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
{\isacharparenleft}induction\ rule{\isacharcolon}\ List{\isachardot}list{\isacharunderscore}induct{\isadigit{2}}{\isacharprime}{\isacharcomma}\ auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lleq{\isacharunderscore}refl{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ x\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}lleq{\isacharunderscore}charlist\ x\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
{\isacharparenleft}induction\ x{\isacharcomma}\ auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lleq{\isacharunderscore}trans{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ x\ y\ z\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}lleq{\isacharunderscore}charlist\ x\ y\ {\isasymLongrightarrow}\ lleq{\isacharunderscore}charlist\ y\ z\ {\isasymLongrightarrow}\ lleq{\isacharunderscore}charlist\ x\ z{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ arbitrary{\isacharcolon}\ z\ rule{\isacharcolon}\ list{\isacharunderscore}induct{\isadigit{2}}{\isacharprime}{\isacharparenright}\ \isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ BothNil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}LeftCons\ x\ xs{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}induction\ y{\isacharparenright}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ lleq{\isacharunderscore}charlist{\isachardot}elims{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ lleq{\isacharunderscore}charlist{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ blast{\isacharplus}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}RightCons\ y\ ys{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}BothCons\ x\ xs\ y\ ys\ z{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ lleq{\isacharunderscore}head{\isacharbrackleft}of\ xs\ ys\ x\ z{\isacharbrackright}\ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}x\ {\isacharequal}\ y{\isachardoublequoteclose}{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ z{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ a\ list\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}x\ {\isacharequal}\ a{\isachardoublequoteclose}{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lleq{\isacharunderscore}antisym{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ x\ y\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}lleq{\isacharunderscore}charlist\ x\ y\ {\isasymLongrightarrow}\ lleq{\isacharunderscore}charlist\ y\ x\ {\isasymLongrightarrow}\ x\ {\isacharequal}\ y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ rule{\isacharcolon}\ list{\isacharunderscore}induct{\isadigit{2}}{\isacharprime}{\isacharparenright}\isanewline
\ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}LeftCons\ x\ xs{\isacharparenright}\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}xs{\isacharequal}y{\isachardoublequoteclose}{\isacharcomma}auto{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}RightCons\ y\ ys{\isacharparenright}\ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}x{\isacharequal}ys{\isachardoublequoteclose}{\isacharcomma}auto{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}BothCons\ x\ xs\ y\ ys{\isacharparenright}\ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}x{\isacharequal}y{\isachardoublequoteclose}{\isacharcomma}\ auto{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lleq{\isacharunderscore}dichotomy{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ x\ y\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}lleq{\isacharunderscore}charlist\ x\ y\ {\isasymor}\ lleq{\isacharunderscore}charlist\ y\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
{\isacharparenleft}induction\ rule{\isacharcolon}\ List{\isachardot}list{\isacharunderscore}induct{\isadigit{2}}{\isacharprime}{\isacharcomma}auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{instance}\isamarkupfalse%
\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}standard{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ less{\isacharunderscore}eq{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}def\ less{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ lleq{\isacharunderscore}less\ lleq{\isacharunderscore}refl\ lleq{\isacharunderscore}trans\ lleq{\isacharunderscore}dichotomy{\isacharparenright}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ lleq{\isacharunderscore}antisym\ less{\isacharunderscore}eq{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}def\ less{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}def\ Rep{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inject\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ string{\isacharunderscore}expose{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}string\ {\isasymRightarrow}\ {\isacharparenleft}unit\ {\isacharplus}\ {\isacharparenleft}char\ {\isacharasterisk}\ string{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}string{\isacharunderscore}expose\ Nil\ {\isacharequal}\ Inl\ {\isacharparenleft}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}string{\isacharunderscore}expose\ {\isacharparenleft}c{\isacharhash}cs{\isacharparenright}\ {\isacharequal}\ Inr{\isacharparenleft}c{\isacharcomma}cs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ string{\isacharunderscore}cons{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}char\ {\isasymRightarrow}\ string\ {\isasymRightarrow}\ string{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}string{\isacharunderscore}cons\ c\ s\ {\isacharequal}\ {\isacharparenleft}if\ length\ s\ {\isasymge}\ MAX{\isacharunderscore}STR\ then\ s\ else\ c\ {\isacharhash}\ s{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\isanewline
\isacommand{lift{\isacharunderscore}definition}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isacharcolon}{\isacharcolon}fin{\isacharunderscore}string\ \isakeyword{is}\ {\isachardoublequoteopen}{\isacharprime}{\isacharprime}{\isacharprime}{\isacharprime}{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ max{\isacharunderscore}str{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isacommand{lift{\isacharunderscore}definition}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}char\ {\isasymRightarrow}\ fin{\isacharunderscore}string\ {\isasymRightarrow}\ fin{\isacharunderscore}string{\isachardoublequoteclose}\ \isakeyword{is}\ {\isachardoublequoteopen}string{\isacharunderscore}cons{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isacommand{lift{\isacharunderscore}definition}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}expose{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}fin{\isacharunderscore}string\ {\isasymRightarrow}\ {\isacharparenleft}unit\ {\isacharplus}\ {\isacharparenleft}char{\isacharasterisk}fin{\isacharunderscore}string{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{is}\ string{\isacharunderscore}expose\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ dual{\isacharunderscore}order{\isachardot}trans\ less{\isacharunderscore}imp{\isacharunderscore}le\ pred{\isacharunderscore}sum{\isachardot}simps\ string{\isacharunderscore}expose{\isachardot}elims{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ dual{\isacharunderscore}order{\isachardot}trans\ impossible{\isacharunderscore}Cons\ le{\isacharunderscore}cases\ string{\isacharunderscore}expose{\isachardot}elims{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Helper functions for enum typeclass instance%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}upto\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ fin{\isacharunderscore}string\ list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}fin{\isacharunderscore}string{\isacharunderscore}upto\ {\isadigit{0}}\ {\isacharequal}\ {\isacharbrackleft}fin{\isacharunderscore}string{\isacharunderscore}empty{\isacharbrackright}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}fin{\isacharunderscore}string{\isacharunderscore}upto\ {\isacharparenleft}Suc\ k{\isacharparenright}\ {\isacharequal}\ \isanewline
\ {\isacharparenleft}let\ r\ {\isacharequal}\ fin{\isacharunderscore}string{\isacharunderscore}upto\ k\ in\isanewline
\ \ let\ ab\ {\isacharequal}\ \ {\isacharparenleft}enum{\isacharunderscore}class{\isachardot}enum{\isacharcolon}{\isacharcolon}char\ list{\isacharparenright}\ in\isanewline
\ \ fin{\isacharunderscore}string{\isacharunderscore}empty\ {\isacharhash}\ concat\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}\ c{\isachardot}\ map\ {\isacharparenleft}{\isasymlambda}s{\isachardot}\ fin{\isacharunderscore}string{\isacharunderscore}cons\ c\ \ s{\isacharparenright}\ r{\isacharparenright}\ ab{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}appL{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ L{\isadigit{1}}\ x\ {\isasymLongrightarrow}\ List{\isachardot}member\ {\isacharparenleft}L{\isadigit{1}}\ {\isacharat}\ L{\isadigit{2}}{\isacharparenright}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}induction\ L{\isadigit{1}}\ arbitrary{\isacharcolon}\ L{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ member{\isacharunderscore}rec{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}appR{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ L{\isadigit{2}}\ x\ {\isasymLongrightarrow}\ List{\isachardot}member\ {\isacharparenleft}L{\isadigit{1}}\ {\isacharat}\ L{\isadigit{2}}{\isacharparenright}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}induction\ L{\isadigit{1}}\ arbitrary{\isacharcolon}\ L{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ member{\isacharunderscore}rec{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}app{\isacharunderscore}or{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}L{\isadigit{1}}\ {\isacharat}\ L{\isadigit{2}}{\isacharparenright}\ x\ {\isacharequal}\ List{\isachardot}member\ L{\isadigit{1}}\ x\ {\isasymor}\ List{\isachardot}member\ L{\isadigit{2}}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ member{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}nil{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ n\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ n{\isacharparenright}\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
{\isacharparenleft}induction\ n{\isacharcomma}\ auto\ simp\ add{\isacharcolon}\ member{\isacharunderscore}rec\ Let{\isacharunderscore}def\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
List of every string. Not practical for code generation but used to show strings are an enum%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ vals{\isacharunderscore}def{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}{\isachardoublequoteopen}vals\ {\isasymequiv}\ fin{\isacharunderscore}string{\isacharunderscore}upto\ MAX{\isacharunderscore}STR{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}enum\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}fin{\isacharunderscore}string\ list{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}fin{\isacharunderscore}string{\isacharunderscore}enum\ {\isacharequal}\ vals{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}enum{\isacharunderscore}all\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}fin{\isacharunderscore}string\ {\isasymRightarrow}\ bool{\isacharparenright}\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}fin{\isacharunderscore}string{\isacharunderscore}enum{\isacharunderscore}all\ {\isacharequal}\ {\isacharparenleft}{\isasymlambda}\ f{\isachardot}\ list{\isacharunderscore}all\ f\ vals{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}enum{\isacharunderscore}ex\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}fin{\isacharunderscore}string\ {\isasymRightarrow}\ bool{\isacharparenright}\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}fin{\isacharunderscore}string{\isacharunderscore}enum{\isacharunderscore}ex\ {\isacharequal}\ {\isacharparenleft}{\isasymlambda}\ f{\isachardot}\ list{\isacharunderscore}ex\ f\ vals{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Induct on the length of a bounded list, with access to index of element%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ length{\isacharunderscore}induct{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ P\isanewline
\ \ \isakeyword{assumes}\ len{\isacharcolon}{\isachardoublequoteopen}length\ L\ {\isasymle}\ MAX{\isacharunderscore}STR{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ BC{\isacharcolon}{\isachardoublequoteopen}P\ {\isacharbrackleft}{\isacharbrackright}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ IS{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}{\isasymAnd}k\ x\ xs{\isachardot}\ \ P\ xs\ k\ {\isasymLongrightarrow}\ P\ {\isacharparenleft}{\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}Suc\ k{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}P\ L\ {\isacharparenleft}length\ L{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}k{\isachardot}\ \ length\ L\ {\isacharequal}\ k\ {\isasymLongrightarrow}\ k\ {\isasymle}\ MAX{\isacharunderscore}STR\ {\isasymLongrightarrow}\ P\ L\ {\isacharparenleft}length\ L{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ L{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{using}\isamarkupfalse%
\ BC\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ L{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ it{\isacharcolon}{\isachardoublequoteopen}P\ {\isacharparenleft}L{\isacharparenright}\ {\isacharparenleft}length\ L{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}imp{\isacharunderscore}le\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \ \isacommand{using}\isamarkupfalse%
\ IS{\isacharbrackleft}OF\ it{\isacharcomma}\ of\ a{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ BC\ IS\ len\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Induct on length of fin-string%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ ilength{\isacharunderscore}induct{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ P\isanewline
\ \ \isakeyword{assumes}\ BC{\isacharcolon}{\isachardoublequoteopen}P\ fin{\isacharunderscore}string{\isacharunderscore}empty\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ IS{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}{\isasymAnd}k\ x\ xs{\isachardot}\ \ P\ xs\ k\ {\isasymLongrightarrow}\ P\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}x\ {\isacharhash}\ Rep{\isacharunderscore}fin{\isacharunderscore}string\ xs{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}Suc\ k{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}P\ L\ {\isacharparenleft}ilength\ L{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ L{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}unfold\ ilength{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ y\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}L\ {\isacharequal}\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}\ length\ y\ {\isasymle}\ MAX{\isacharunderscore}STR\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ main{\isacharcolon}{\isachardoublequoteopen}{\isasymAnd}k{\isachardot}\ L\ {\isacharequal}\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ y\ {\isasymLongrightarrow}\ length\ y\ {\isacharequal}\ k\ {\isasymLongrightarrow}\ k\ {\isasymle}\ MAX{\isacharunderscore}STR\ \isanewline
\ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ P\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ y{\isacharparenright}\ {\isacharparenleft}length\ y{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ k\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}induction\ y\ arbitrary{\isacharcolon}\ k\ L{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ k\ \isacommand{using}\isamarkupfalse%
\ BC\ \isacommand{unfolding}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ a\ y\ k\ L\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ IH{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}{\isasymAnd}k\ L{\isachardot}\ L\ {\isacharequal}\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ y\ {\isasymLongrightarrow}\ length\ y\ {\isacharequal}\ k\ {\isasymLongrightarrow}\ k\ {\isasymle}\ MAX{\isacharunderscore}STR\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ P\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ y{\isacharparenright}\ {\isacharparenleft}length\ y{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ L{\isacharcolon}{\isachardoublequoteopen}L\ {\isacharequal}\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}a\ {\isacharhash}\ y{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ l{\isacharcolon}{\isachardoublequoteopen}length\ {\isacharparenleft}a\ {\isacharhash}\ y{\isacharparenright}\ {\isacharequal}\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ str{\isacharcolon}{\isachardoublequoteopen}k\ {\isasymle}\ MAX{\isacharunderscore}STR{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ yLen{\isacharcolon}{\isachardoublequoteopen}length\ y\ {\isacharless}\ MAX{\isacharunderscore}STR{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ l\ str\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ it{\isacharcolon}{\isachardoublequoteopen}P\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ y{\isacharparenright}\ {\isacharparenleft}length\ y{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ IH{\isacharbrackleft}of\ {\isachardoublequoteopen}Abs{\isacharunderscore}fin{\isacharunderscore}string\ y{\isachardoublequoteclose}\ {\isachardoublequoteopen}k{\isacharminus}{\isadigit{1}}{\isachardoublequoteclose}{\isacharcomma}\ OF\ refl{\isacharbrackright}\ \isacommand{using}\isamarkupfalse%
\ L\ l\ str\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ \ {\isachardoublequoteopen}P\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}a\ {\isacharhash}\ y{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}length\ {\isacharparenleft}a\ {\isacharhash}\ y{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ IS{\isacharbrackleft}OF\ it{\isacharcomma}\ of\ a{\isacharbrackright}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isacharunderscore}def\ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}MAX{\isacharunderscore}STR\ {\isasymle}\ length\ {\isacharparenleft}Rep{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ y{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ yLen\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ l\ yLen\ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ main{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ BC\ IS\ a{\isadigit{1}}\ a{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ enum{\isacharunderscore}chars{\isacharcolon}{\isachardoublequoteopen}set\ {\isacharparenleft}enum{\isacharunderscore}class{\isachardot}enum{\isacharcolon}{\isacharcolon}char\ list{\isacharparenright}{\isacharequal}\ UNIV{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ \ \ Enum{\isachardot}enum{\isacharunderscore}class{\isachardot}enum{\isacharunderscore}UNIV\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ member{\isacharunderscore}concat{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}concat\ LL{\isacharparenright}\ x\ {\isacharequal}\ {\isacharparenleft}{\isasymexists}L{\isachardot}\ List{\isachardot}member\ LL\ L\ {\isasymand}\ List{\isachardot}member\ L\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ member{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
fin-string-upto k enumerates all strings up to length $min(k,MAX\_STR)$%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}length{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ L{\isacharcolon}{\isacharcolon}string\isanewline
\ \ \isakeyword{assumes}\ len{\isacharcolon}{\isachardoublequoteopen}length\ L\ {\isasymle}\ k{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ Len{\isacharcolon}{\isachardoublequoteopen}length\ L\ {\isasymle}\ MAX{\isacharunderscore}STR{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ k{\isacharparenright}\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ L{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ BC{\isacharcolon}{\isachardoublequoteopen}{\isasymforall}j{\isasymge}{\isadigit{0}}{\isachardot}\ {\isadigit{0}}\ {\isasymle}\ MAX{\isacharunderscore}STR\ {\isasymlongrightarrow}\ length\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto{\isacharparenright}\ \isanewline
\ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ j\ \isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ j{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isacharunderscore}def\ member{\isacharunderscore}rec{\isacharparenright}\ \isanewline
\ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ IS{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}{\isasymAnd}k\ x\ xs{\isachardot}\isanewline
\ \ \ \ \ \ {\isasymforall}j{\isasymge}k{\isachardot}\ k{\isasymle}MAX{\isacharunderscore}STR\ {\isasymlongrightarrow}\ length\ xs{\isacharequal}k\ {\isasymlongrightarrow}\ List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ xs{\isacharparenright}{\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ {\isasymforall}j{\isasymge}Suc\ k{\isachardot}\ Suc\ k\ {\isasymle}\ MAX{\isacharunderscore}STR\ {\isasymlongrightarrow}\ length\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharequal}\ Suc\ k\ \isanewline
\ \ \ \ \ \ \ \ {\isasymlongrightarrow}\ List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ k\ x\ xs\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}j{\isasymge}k{\isachardot}\ k\ {\isasymle}\ MAX{\isacharunderscore}STR\ {\isasymlongrightarrow}\ length\ xs\ {\isacharequal}\ k\ \isanewline
\ \ \ \ \ \ \ \ {\isasymlongrightarrow}\ List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ IH{\isacharcolon}{\isachardoublequoteopen}{\isasymAnd}j{\isachardot}\ j{\isasymge}\ k\ {\isasymLongrightarrow}\ k\ {\isasymle}\ MAX{\isacharunderscore}STR\ {\isasymLongrightarrow}\ length\ xs\ {\isacharequal}\ k\ \isanewline
\ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ xs{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ j\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ kj{\isacharcolon}{\isachardoublequoteopen}Suc\ {\isacharparenleft}length\ xs{\isacharparenright}\ {\isasymle}\ j{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ sucMax{\isacharcolon}{\isachardoublequoteopen}Suc\ {\isacharparenleft}length\ xs{\isacharparenright}\ {\isasymle}\ MAX{\isacharunderscore}STR{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ ilen{\isacharcolon}{\isachardoublequoteopen}\ k\ {\isacharequal}\ length\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ jj\ \isakeyword{where}\ jj{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}{\isachardoublequoteopen}j\ {\isacharequal}\ Suc\ jj{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ kj\ Suc{\isacharunderscore}le{\isacharunderscore}D\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ kMax{\isacharcolon}{\isachardoublequoteopen}k\ {\isacharless}\ MAX{\isacharunderscore}STR{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ jj\ kj\ Suc{\isacharunderscore}le{\isacharunderscore}D\ ilen\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ less{\isacharunderscore}eq{\isacharunderscore}Suc{\isacharunderscore}le\ sucMax{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ res{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ {\isacharparenleft}jj{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ IH{\isacharbrackleft}of\ {\isachardoublequoteopen}jj{\isachardoublequoteclose}{\isacharbrackright}\ kj\ jj\ ilen\ \ Suc{\isacharunderscore}leD\ sucMax\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ neq{\isacharcolon}{\isachardoublequoteopen}Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymnoteq}\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isachardot}abs{\isacharunderscore}eq\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isachardot}rep{\isacharunderscore}eq\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ len\ length{\isacharunderscore}Cons\ list{\isachardot}distinct{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ mem{\isacharunderscore}Collect{\isacharunderscore}eq\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ ilen\ sucMax{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ univ{\isacharcolon}{\isachardoublequoteopen}\ set\ enum{\isacharunderscore}class{\isachardot}enum\ \ {\isacharequal}\ {\isacharparenleft}UNIV{\isacharcolon}{\isacharcolon}char\ set{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ enum{\isacharunderscore}chars\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ member{\isacharunderscore}rec{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ len\ sucMax\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ member{\isacharunderscore}rec\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isacharunderscore}def\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ Rep{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ neq{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}witLL\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymlambda}\ x{\isachardot}\ map\ {\isacharparenleft}map{\isacharunderscore}fun\ Rep{\isacharunderscore}fin{\isacharunderscore}string\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}string{\isacharunderscore}cons\ x{\isacharparenright}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ jj{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}Abs{\isacharunderscore}fin{\isacharunderscore}string\ xs\ {\isasymin}\ set\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ jj{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ member{\isacharunderscore}def\ res{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharequal}\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}if\ MAX{\isacharunderscore}STR\ {\isasymle}\ length\ {\isacharparenleft}Rep{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ xs{\isacharparenright}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ then\ Rep{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ xs{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ x\ {\isacharhash}\ Rep{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ xs{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ ilen\ kMax\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ ex{\isacharcolon}{\isachardoublequoteopen}{\isasymexists}\ LL{\isachardot}\ {\isacharparenleft}List{\isachardot}member\ {\isacharparenleft}map\ {\isacharquery}witLL\ enum{\isacharunderscore}class{\isachardot}enum{\isacharparenright}\ LL{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ List{\isachardot}member\ LL\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ exI{\isacharbrackleft}\isakeyword{where}\ x{\isacharequal}{\isachardoublequoteopen}{\isacharquery}witLL\ x{\isachardoublequoteclose}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ member{\isacharunderscore}def\ univ{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{1}}\ f{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}concat\ {\isacharparenleft}map\ {\isacharquery}witLL\ enum{\isacharunderscore}class{\isachardot}enum{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ member{\isacharunderscore}concat\ ex\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ impl{\isacharcolon}{\isachardoublequoteopen}length\ L\ {\isasymle}\ k\ {\isasymLongrightarrow}\ List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ k{\isacharparenright}\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ L{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ len\ Len\ \isanewline
\ \ \ \ length{\isacharunderscore}induct{\isacharbrackleft}\isakeyword{where}\ P\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymlambda}\ L\ k{\isachardot}\ {\isasymforall}\ j\ {\isasymge}\ k{\isachardot}\ k\ {\isasymle}\ MAX{\isacharunderscore}STR\ {\isasymlongrightarrow}\ length\ L\ {\isacharequal}\ k\ \isanewline
\ \ \ \ \ \ \ \ {\isasymlongrightarrow}\ List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}\ {\isacharparenleft}Abs{\isacharunderscore}fin{\isacharunderscore}string\ L{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isacharcomma}\ OF\ Len\ BC\ IS{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ impl\ len\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}upto{\isacharunderscore}length{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ n{\isacharparenright}\ L\ {\isasymLongrightarrow}\ ilength\ L\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}induction\ n\ arbitrary{\isacharcolon}\ L{\isacharparenright}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isacharunderscore}def\ Let{\isacharunderscore}def\ ilength{\isacharunderscore}def\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isacharunderscore}def\ \isanewline
\ \ \ \ \ Rep{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ member{\isacharunderscore}rec{\isacharparenright}\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ n\ L\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}witLL{\isacharequal}{\isachardoublequoteopen}{\isacharparenleft}{\isasymlambda}x{\isachardot}\ map{\isacharparenleft}map{\isacharunderscore}fun\ Rep{\isacharunderscore}fin{\isacharunderscore}string\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}string{\isacharunderscore}cons\ x{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ n{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ len{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}{\isasymAnd}L{\isachardot}\ List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ n{\isacharparenright}\ L\ {\isasymLongrightarrow}\ length\ {\isacharparenleft}Rep{\isacharunderscore}fin{\isacharunderscore}string\ L{\isacharparenright}\ {\isasymle}\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ mem{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}concat\ {\isacharparenleft}map\ {\isacharquery}witLL\ enum{\isacharunderscore}class{\isachardot}enum{\isacharparenright}{\isacharparenright}\ L{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ L{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ n{\isacharparenright}\ L\ {\isasymLongrightarrow}\ length\ {\isacharparenleft}Rep{\isacharunderscore}fin{\isacharunderscore}string\ L{\isacharparenright}\ {\isasymle}\ Suc\ n{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ len{\isacharbrackleft}of\ L{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ R{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}concat\ {\isacharparenleft}map\ {\isacharquery}witLL\ enum{\isacharunderscore}class{\isachardot}enum{\isacharparenright}{\isacharparenright}\ L\isanewline
\ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ length\ {\isacharparenleft}Rep{\isacharunderscore}fin{\isacharunderscore}string\ L{\isacharparenright}\ {\isasymle}\ Suc\ n{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}concat\ {\isacharparenleft}map\ {\isacharquery}witLL\ enum{\isacharunderscore}class{\isachardot}enum{\isacharparenright}{\isacharparenright}\ L{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ LL\ \isakeyword{where}\ conc{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}map\ {\isacharquery}witLL\ enum{\isacharunderscore}class{\isachardot}enum{\isacharparenright}\ LL{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ concmem{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ LL\ L{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ member{\isacharunderscore}concat\ a\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ c\ cs\ \isakeyword{where}\ c{\isacharcolon}{\isachardoublequoteopen}L\ {\isacharequal}\ fin{\isacharunderscore}string{\isacharunderscore}cons\ c\ cs{\isachardoublequoteclose}\ \isakeyword{and}\ cs{\isacharcolon}{\isachardoublequoteopen}List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ n{\isacharparenright}\ cs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ conc\ \isacommand{unfolding}\isamarkupfalse%
\ member{\isacharunderscore}def\ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ c\ d\ cs\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}MAX{\isacharunderscore}STR\ {\isasymle}\ length\ {\isacharparenleft}Rep{\isacharunderscore}fin{\isacharunderscore}string\ cs{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ Rep{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}full{\isacharunderscore}types{\isacharparenright}\ Rep{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isachardot}rep{\isacharunderscore}eq\ string{\isacharunderscore}cons{\isachardot}simps{\isacharparenright}{\isacharplus}\ \isanewline
\ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ilength\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}cons\ c\ cs{\isacharparenright}\ {\isasymle}\ {\isacharparenleft}Suc\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ len{\isacharbrackleft}of\ cs{\isacharbrackright}\ \isacommand{unfolding}\isamarkupfalse%
\ ilength{\isacharunderscore}def\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isacharunderscore}def\ \isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ Rep{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ c\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isachardot}rep{\isacharunderscore}eq\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ c\ ilength{\isachardot}rep{\isacharunderscore}eq\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}Rep{\isacharunderscore}fin{\isacharunderscore}string\ L{\isacharparenright}\ {\isasymle}\ Suc\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ L\ R\ \ mem\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
fin-string-upto produces no duplicate identifiers%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ distinct{\isacharunderscore}upto{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}i\ {\isasymle}\ MAX{\isacharunderscore}STR\ {\isasymLongrightarrow}\ distinct\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ i{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ i{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Suc\ j{\isacharparenright}\ \isacommand{then}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ jLen{\isacharcolon}{\isachardoublequoteopen}Suc\ j\ {\isasymle}\ MAX{\isacharunderscore}STR{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ IH{\isacharcolon}{\isachardoublequoteopen}distinct\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ distinct{\isacharunderscore}char{\isacharcolon}{\isachardoublequoteopen}distinct\ {\isacharparenleft}enum{\isacharunderscore}class{\isachardot}enum{\isacharcolon}{\isacharcolon}\ char\ list{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ distinct{\isacharunderscore}map\ enum{\isacharunderscore}char{\isacharunderscore}unfold{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ diseq{\isacharcolon}{\isachardoublequoteopen}{\isasymAnd}\ x\ y{\isachardot}\ y\ {\isasymin}\ set\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}\ {\isasymLongrightarrow}\ \ fin{\isacharunderscore}string{\isacharunderscore}empty\ {\isasymnoteq}\ fin{\isacharunderscore}string{\isacharunderscore}cons\ x\ y{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Rep{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ jLen\ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isacharunderscore}def\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isachardot}rep{\isacharunderscore}eq\ le{\isacharunderscore}zero{\isacharunderscore}eq\ list{\isachardot}size\ not{\isacharunderscore}less{\isacharunderscore}eq{\isacharunderscore}eq\ zero{\isacharunderscore}le\ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inject\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis{\isacharcomma}auto{\isacharparenright}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ Let{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ x\ xa\ \isacommand{using}\isamarkupfalse%
\ diseq\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ distinct{\isacharunderscore}concat{\isacharparenright}\isanewline
\ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ distinct{\isacharunderscore}map{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ distinct{\isacharunderscore}char{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ subset{\isacharunderscore}inj{\isacharunderscore}on{\isacharbrackleft}\isakeyword{where}\ B{\isacharequal}UNIV{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ injI{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\isanewline
\ \ \ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}l\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymlambda}xa\ x{\isachardot}\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ \isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}if\ MAX{\isacharunderscore}STR\ {\isasymle}\ length\ {\isacharparenleft}Rep{\isacharunderscore}fin{\isacharunderscore}string\ xa{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ then\ Rep{\isacharunderscore}fin{\isacharunderscore}string\ xa\ \isanewline
\ \ \ \ \ \ \ \ \ else\ x\ {\isacharhash}\ Rep{\isacharunderscore}fin{\isacharunderscore}string\ xa{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}{\isasymforall}xa{\isasymin}set\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}{\isachardot}\ {\isacharquery}l\ xa\ x\ {\isacharequal}\ {\isacharquery}l\ xa\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}{\isasymAnd}xa{\isachardot}\ {\isacharparenleft}List{\isachardot}member\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}\ xa{\isacharparenright}\ {\isasymLongrightarrow}\ {\isacharquery}l\ xa\ x\ {\isacharequal}\ {\isacharquery}l\ xa\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ member{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharbrackleft}x{\isacharbrackright}\ {\isacharequal}\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharbrackleft}y{\isacharbrackright}\ {\isasymor}\ {\isacharparenleft}MAX{\isacharunderscore}STR{\isacharcolon}{\isacharcolon}nat{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isadigit{2}}\ fin{\isacharunderscore}string{\isacharunderscore}empty{\isachardot}rep{\isacharunderscore}eq\ fin{\isacharunderscore}string{\isacharunderscore}nil\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ jLen\ le{\isacharunderscore}zero{\isacharunderscore}eq\ length{\isacharunderscore}Cons\ list{\isachardot}inject\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ mem{\isacharunderscore}Collect{\isacharunderscore}eq\ nat{\isachardot}distinct{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ not{\isacharunderscore}less{\isacharunderscore}eq{\isacharunderscore}eq{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ ys\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ c\ {\isacharcolon}{\isacharcolon}\ char\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ c{\isacharcolon}{\isachardoublequoteopen}c\ {\isasymin}\ set\ enum{\isacharunderscore}class{\isachardot}enum{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ ys{\isacharcolon}{\isachardoublequoteopen}ys{\isacharequal}map{\isacharparenleft}map{\isacharunderscore}fun\ Rep{\isacharunderscore}fin{\isacharunderscore}string\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}string{\isacharunderscore}cons\ c{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
{\isachardoublequoteopen}distinct{\isacharparenleft}map{\isacharparenleft}map{\isacharunderscore}fun\ Rep{\isacharunderscore}fin{\isacharunderscore}string\ Abs{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharparenleft}string{\isacharunderscore}cons\ c{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}fin{\isacharunderscore}string{\isacharunderscore}upto\ j{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ distinct{\isacharunderscore}map\ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ conjI{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ IH{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ inj{\isacharunderscore}onI{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ x\ y\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ jLen\ fin{\isacharunderscore}string{\isacharunderscore}upto{\isacharunderscore}length{\isacharbrackleft}of\ j\ x{\isacharbrackright}\ fin{\isacharunderscore}string{\isacharunderscore}upto{\isacharunderscore}length{\isacharbrackleft}of\ j\ y{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ List{\isachardot}member{\isacharunderscore}def\ ilength{\isacharunderscore}def\ \isacommand{apply}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ hide{\isacharunderscore}lams{\isacharparenright}\ Rep{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isachardot}rep{\isacharunderscore}eq\ le{\isacharunderscore}trans\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ list{\isachardot}inject\ not{\isacharunderscore}less{\isacharunderscore}eq{\isacharunderscore}eq\ string{\isacharunderscore}cons{\isachardot}simps{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{subgoal}\isamarkupfalse%
\ \isakeyword{for}\ c\ ca\ xa\ xb\ xc\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}MAX{\isacharunderscore}STR\ {\isasymle}\ length\ {\isacharparenleft}Rep{\isacharunderscore}fin{\isacharunderscore}string\ xa{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}metis\ fin{\isacharunderscore}string{\isacharunderscore}upto{\isacharunderscore}length\ jLen\ ilength{\isachardot}rep{\isacharunderscore}eq\ le{\isacharunderscore}trans\ member{\isacharunderscore}def\ not{\isacharunderscore}less{\isacharunderscore}eq{\isacharunderscore}eq{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}MAX{\isacharunderscore}STR\ {\isasymle}\ length\ {\isacharparenleft}Rep{\isacharunderscore}fin{\isacharunderscore}string\ xb{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}metis\ fin{\isacharunderscore}string{\isacharunderscore}upto{\isacharunderscore}length\ jLen\ ilength{\isachardot}rep{\isacharunderscore}eq\ le{\isacharunderscore}trans\ member{\isacharunderscore}def\ not{\isacharunderscore}less{\isacharunderscore}eq{\isacharunderscore}eq{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}MAX{\isacharunderscore}STR\ {\isasymle}\ length\ {\isacharparenleft}Rep{\isacharunderscore}fin{\isacharunderscore}string\ xc{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto{\isacharcomma}metis\ Rep{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ fin{\isacharunderscore}string{\isacharunderscore}cons{\isachardot}rep{\isacharunderscore}eq\ list{\isachardot}inject\ string{\isacharunderscore}cons{\isachardot}simps{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Finite strings are an enumeration type%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{instantiation}\isamarkupfalse%
\ fin{\isacharunderscore}string\ {\isacharcolon}{\isacharcolon}\ enum\ \isakeyword{begin}\isanewline
\isacommand{definition}\isamarkupfalse%
\ enum{\isacharunderscore}fin{\isacharunderscore}string\ \isanewline
\ \ \isakeyword{where}\ enum{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}def{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}{\isachardoublequoteopen}enum{\isacharunderscore}fin{\isacharunderscore}string\ {\isasymequiv}\ fin{\isacharunderscore}string{\isacharunderscore}enum{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ enum{\isacharunderscore}all{\isacharunderscore}fin{\isacharunderscore}string\isanewline
\ \ \isakeyword{where}\ enum{\isacharunderscore}all{\isacharunderscore}fin{\isacharunderscore}string{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}{\isachardoublequoteopen}enum{\isacharunderscore}all{\isacharunderscore}fin{\isacharunderscore}string\ {\isasymequiv}\ fin{\isacharunderscore}string{\isacharunderscore}enum{\isacharunderscore}all{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ enum{\isacharunderscore}ex{\isacharunderscore}fin{\isacharunderscore}string\isanewline
\ \ \isakeyword{where}\ enum{\isacharunderscore}ex{\isacharunderscore}fin{\isacharunderscore}string{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}{\isachardoublequoteopen}enum{\isacharunderscore}ex{\isacharunderscore}fin{\isacharunderscore}string\ {\isasymequiv}\ fin{\isacharunderscore}string{\isacharunderscore}enum{\isacharunderscore}ex{\isachardoublequoteclose}\isanewline
\isacommand{lemma}\isamarkupfalse%
\ enum{\isacharunderscore}ALL{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}UNIV{\isacharcolon}{\isacharcolon}fin{\isacharunderscore}string\ set{\isacharparenright}\ {\isacharequal}\ set\ enum{\isacharunderscore}class{\isachardot}enum{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}enum{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}def\ fin{\isacharunderscore}string{\isacharunderscore}enum{\isacharunderscore}def\ vals{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}metis\ fin{\isacharunderscore}string{\isacharunderscore}length\ List{\isachardot}member{\isacharunderscore}def\ mem{\isacharunderscore}Collect{\isacharunderscore}eq\ Abs{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}cases{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ vals{\isacharunderscore}ALL{\isacharcolon}{\isachardoublequoteopen}set\ {\isacharparenleft}vals{\isacharcolon}{\isacharcolon}fin{\isacharunderscore}string\ list{\isacharparenright}\ {\isacharequal}\ UNIV{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ enum{\isacharunderscore}ALL\ vals{\isacharunderscore}def\ Rep{\isacharunderscore}fin{\isacharunderscore}string\ fin{\isacharunderscore}string{\isacharunderscore}length\ ilength{\isachardot}rep{\isacharunderscore}eq\ member{\isacharunderscore}def\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharparenright}\ Rep{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}inverse\ UNIV{\isacharunderscore}eq{\isacharunderscore}I\ mem{\isacharunderscore}Collect{\isacharunderscore}eq{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ setA{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ set{\isacharcolon}{\isachardoublequoteopen}{\isasymAnd}y{\isachardot}\ y\ {\isasymin}\ set\ L\ {\isasymLongrightarrow}\ P\ y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}list{\isacharunderscore}all\ P\ L{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ set\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ list{\isachardot}pred{\isacharunderscore}set{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ setE{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ set{\isacharcolon}{\isachardoublequoteopen}\ y\ {\isasymin}\ set\ L{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ P{\isacharcolon}{\isachardoublequoteopen}P\ y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}list{\isacharunderscore}ex\ P\ L{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ set\ P\ \ list{\isacharunderscore}ex{\isacharunderscore}iff\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{instance}\isamarkupfalse%
\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}standard{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}rule\ enum{\isacharunderscore}ALL{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ fin{\isacharunderscore}string{\isacharunderscore}enum{\isacharunderscore}all{\isacharunderscore}def\ list{\isacharunderscore}all{\isacharunderscore}iff\ vals{\isacharunderscore}ALL\ setA\ setE\ enum{\isacharunderscore}all{\isacharunderscore}fin{\isacharunderscore}string\isanewline
\ \ \ \ \ \ enum{\isacharunderscore}ALL\ fin{\isacharunderscore}string{\isacharunderscore}enum{\isacharunderscore}def\ vals{\isacharunderscore}def\ enum{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}def\ distinct{\isacharunderscore}upto\ list{\isacharunderscore}ex{\isacharunderscore}iff\ \isanewline
\ \ \ \ \ \ enum{\isacharunderscore}ex{\isacharunderscore}fin{\isacharunderscore}string\ fin{\isacharunderscore}string{\isacharunderscore}enum{\isacharunderscore}ex{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ fin{\isacharunderscore}string\ {\isacharcolon}{\isacharcolon}\ equal\ \isakeyword{begin}\isanewline
\isacommand{definition}\isamarkupfalse%
\ equal{\isacharunderscore}fin{\isacharunderscore}string\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}fin{\isacharunderscore}string\ {\isasymRightarrow}\ fin{\isacharunderscore}string\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}{\isachardoublequoteopen}equal{\isacharunderscore}fin{\isacharunderscore}string\ X\ Y\ {\isacharequal}\ {\isacharparenleft}X\ {\isasymle}\ Y\ {\isasymand}\ Y\ {\isasymle}\ X{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isacommand{instance}\isamarkupfalse%
\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}standard{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto\ simp\ add{\isacharcolon}\ equal{\isacharunderscore}fin{\isacharunderscore}string{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{end}\isamarkupfalse%
\isanewline
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/soft/afp/thys/Interval_Arithmetic/Finite_String.thy%:%
%:%6=1%:%
%:%7=2%:%
%:%8=3%:%
%:%9=4%:%
%:%10=5%:%
%:%11=6%:%
%:%12=7%:%
%:%13=8%:%
%:%14=9%:%
%:%15=10%:%
%:%16=11%:%
%:%24=13%:%
%:%25=13%:%
%:%26=14%:%
%:%27=15%:%
%:%28=16%:%
%:%29=17%:%
%:%38=19%:%
%:%40=20%:%
%:%41=20%:%
%:%43=22%:%
%:%45=23%:%
%:%46=23%:%
%:%48=25%:%
%:%50=26%:%
%:%51=26%:%
%:%52=27%:%
%:%55=28%:%
%:%59=28%:%
%:%60=28%:%
%:%61=29%:%
%:%62=29%:%
%:%63=30%:%
%:%64=30%:%
%:%73=32%:%
%:%75=33%:%
%:%76=33%:%
%:%77=34%:%
%:%78=34%:%
%:%80=34%:%
%:%84=34%:%
%:%94=36%:%
%:%96=37%:%
%:%97=37%:%
%:%98=38%:%
%:%99=39%:%
%:%100=40%:%
%:%103=41%:%
%:%107=41%:%
%:%108=41%:%
%:%109=41%:%
%:%114=41%:%
%:%117=42%:%
%:%118=43%:%
%:%119=43%:%
%:%120=44%:%
%:%122=46%:%
%:%124=47%:%
%:%125=47%:%
%:%126=48%:%
%:%129=48%:%
%:%133=48%:%
%:%134=48%:%
%:%135=49%:%
%:%136=49%:%
%:%137=50%:%
%:%138=50%:%
%:%139=51%:%
%:%140=51%:%
%:%141=52%:%
%:%142=52%:%
%:%143=53%:%
%:%144=53%:%
%:%145=54%:%
%:%146=54%:%
%:%147=54%:%
%:%148=54%:%
%:%149=55%:%
%:%150=55%:%
%:%151=56%:%
%:%152=56%:%
%:%153=57%:%
%:%154=57%:%
%:%155=58%:%
%:%156=58%:%
%:%157=59%:%
%:%158=59%:%
%:%159=60%:%
%:%160=60%:%
%:%161=61%:%
%:%162=61%:%
%:%163=62%:%
%:%164=62%:%
%:%165=63%:%
%:%166=63%:%
%:%167=64%:%
%:%168=64%:%
%:%169=64%:%
%:%170=64%:%
%:%171=65%:%
%:%172=65%:%
%:%173=65%:%
%:%174=65%:%
%:%175=66%:%
%:%176=66%:%
%:%177=67%:%
%:%178=67%:%
%:%179=67%:%
%:%180=68%:%
%:%181=68%:%
%:%182=69%:%
%:%183=69%:%
%:%184=70%:%
%:%185=70%:%
%:%186=71%:%
%:%187=71%:%
%:%188=71%:%
%:%189=71%:%
%:%190=72%:%
%:%191=72%:%
%:%192=72%:%
%:%193=72%:%
%:%194=73%:%
%:%195=73%:%
%:%196=73%:%
%:%197=74%:%
%:%198=74%:%
%:%199=74%:%
%:%200=74%:%
%:%201=75%:%
%:%202=75%:%
%:%203=75%:%
%:%204=76%:%
%:%205=76%:%
%:%206=76%:%
%:%207=77%:%
%:%208=77%:%
%:%209=77%:%
%:%210=78%:%
%:%211=78%:%
%:%212=79%:%
%:%213=79%:%
%:%214=79%:%
%:%215=80%:%
%:%216=80%:%
%:%217=81%:%
%:%218=81%:%
%:%219=81%:%
%:%220=82%:%
%:%221=82%:%
%:%222=83%:%
%:%223=83%:%
%:%224=84%:%
%:%225=84%:%
%:%226=85%:%
%:%227=85%:%
%:%228=86%:%
%:%229=86%:%
%:%230=86%:%
%:%231=87%:%
%:%232=87%:%
%:%233=88%:%
%:%234=88%:%
%:%235=89%:%
%:%236=89%:%
%:%237=90%:%
%:%238=90%:%
%:%239=90%:%
%:%240=90%:%
%:%241=90%:%
%:%242=91%:%
%:%243=91%:%
%:%244=91%:%
%:%245=91%:%
%:%246=92%:%
%:%254=92%:%
%:%255=93%:%
%:%258=95%:%
%:%260=96%:%
%:%261=96%:%
%:%262=97%:%
%:%263=97%:%
%:%264=98%:%
%:%265=99%:%
%:%266=99%:%
%:%267=100%:%
%:%268=101%:%
%:%269=101%:%
%:%272=102%:%
%:%276=102%:%
%:%277=102%:%
%:%282=102%:%
%:%285=103%:%
%:%288=105%:%
%:%290=106%:%
%:%291=106%:%
%:%292=107%:%
%:%293=107%:%
%:%294=108%:%
%:%295=109%:%
%:%296=110%:%
%:%297=111%:%
%:%298=112%:%
%:%299=113%:%
%:%300=114%:%
%:%301=115%:%
%:%302=115%:%
%:%303=116%:%
%:%304=117%:%
%:%305=118%:%
%:%306=119%:%
%:%307=120%:%
%:%308=121%:%
%:%309=122%:%
%:%310=123%:%
%:%311=123%:%
%:%313=123%:%
%:%317=123%:%
%:%325=123%:%
%:%326=124%:%
%:%327=124%:%
%:%329=124%:%
%:%333=124%:%
%:%341=124%:%
%:%342=125%:%
%:%343=126%:%
%:%344=126%:%
%:%345=127%:%
%:%346=128%:%
%:%347=129%:%
%:%348=130%:%
%:%349=131%:%
%:%350=132%:%
%:%353=133%:%
%:%357=133%:%
%:%358=133%:%
%:%359=133%:%
%:%364=133%:%
%:%367=134%:%
%:%368=135%:%
%:%369=135%:%
%:%370=136%:%
%:%371=137%:%
%:%374=138%:%
%:%378=138%:%
%:%379=138%:%
%:%384=138%:%
%:%387=139%:%
%:%388=140%:%
%:%389=140%:%
%:%390=141%:%
%:%391=142%:%
%:%394=143%:%
%:%398=143%:%
%:%399=143%:%
%:%404=143%:%
%:%407=144%:%
%:%408=145%:%
%:%409=145%:%
%:%410=146%:%
%:%411=147%:%
%:%418=148%:%
%:%419=148%:%
%:%420=149%:%
%:%421=149%:%
%:%422=150%:%
%:%423=150%:%
%:%424=150%:%
%:%425=150%:%
%:%426=151%:%
%:%427=151%:%
%:%428=152%:%
%:%429=152%:%
%:%430=153%:%
%:%431=153%:%
%:%432=153%:%
%:%433=154%:%
%:%434=154%:%
%:%435=155%:%
%:%436=155%:%
%:%437=155%:%
%:%438=156%:%
%:%439=156%:%
%:%440=157%:%
%:%441=157%:%
%:%442=158%:%
%:%443=158%:%
%:%444=158%:%
%:%445=158%:%
%:%446=159%:%
%:%447=159%:%
%:%448=160%:%
%:%449=160%:%
%:%450=161%:%
%:%451=161%:%
%:%452=161%:%
%:%453=162%:%
%:%454=162%:%
%:%455=162%:%
%:%456=163%:%
%:%457=163%:%
%:%458=164%:%
%:%459=164%:%
%:%460=165%:%
%:%461=165%:%
%:%462=166%:%
%:%463=166%:%
%:%464=167%:%
%:%470=167%:%
%:%473=168%:%
%:%474=169%:%
%:%475=169%:%
%:%476=170%:%
%:%477=171%:%
%:%484=172%:%
%:%485=172%:%
%:%486=173%:%
%:%487=173%:%
%:%488=173%:%
%:%489=173%:%
%:%490=173%:%
%:%491=174%:%
%:%492=174%:%
%:%493=174%:%
%:%494=174%:%
%:%495=174%:%
%:%496=174%:%
%:%497=175%:%
%:%498=175%:%
%:%499=175%:%
%:%500=175%:%
%:%501=175%:%
%:%502=175%:%
%:%503=176%:%
%:%504=176%:%
%:%509=176%:%
%:%512=177%:%
%:%513=178%:%
%:%514=178%:%
%:%515=179%:%
%:%516=180%:%
%:%519=181%:%
%:%523=181%:%
%:%524=181%:%
%:%529=181%:%
%:%532=182%:%
%:%533=183%:%
%:%534=183%:%
%:%537=184%:%
%:%541=184%:%
%:%542=184%:%
%:%543=185%:%
%:%544=185%:%
%:%545=186%:%
%:%546=186%:%
%:%547=187%:%
%:%548=187%:%
%:%549=187%:%
%:%554=187%:%
%:%557=188%:%
%:%558=188%:%
%:%559=189%:%
%:%560=190%:%
%:%561=190%:%
%:%562=191%:%
%:%563=192%:%
%:%564=193%:%
%:%565=194%:%
%:%566=194%:%
%:%567=195%:%
%:%568=196%:%
%:%569=197%:%
%:%570=197%:%
%:%572=197%:%
%:%576=197%:%
%:%577=197%:%
%:%584=197%:%
%:%585=198%:%
%:%586=198%:%
%:%588=198%:%
%:%592=198%:%
%:%593=198%:%
%:%600=198%:%
%:%601=199%:%
%:%602=199%:%
%:%605=200%:%
%:%609=200%:%
%:%610=200%:%
%:%611=201%:%
%:%612=201%:%
%:%621=204%:%
%:%623=205%:%
%:%624=205%:%
%:%625=206%:%
%:%626=207%:%
%:%627=208%:%
%:%630=211%:%
%:%631=212%:%
%:%632=213%:%
%:%633=213%:%
%:%636=214%:%
%:%640=214%:%
%:%641=214%:%
%:%642=215%:%
%:%643=215%:%
%:%648=215%:%
%:%651=216%:%
%:%652=217%:%
%:%653=217%:%
%:%656=218%:%
%:%660=218%:%
%:%661=218%:%
%:%662=219%:%
%:%663=219%:%
%:%668=219%:%
%:%671=220%:%
%:%672=221%:%
%:%673=221%:%
%:%676=222%:%
%:%680=222%:%
%:%681=222%:%
%:%682=222%:%
%:%687=222%:%
%:%690=223%:%
%:%691=224%:%
%:%692=224%:%
%:%693=225%:%
%:%694=226%:%
%:%697=227%:%
%:%701=227%:%
%:%702=227%:%
%:%711=229%:%
%:%713=230%:%
%:%714=230%:%
%:%715=231%:%
%:%716=232%:%
%:%717=232%:%
%:%718=233%:%
%:%719=234%:%
%:%720=234%:%
%:%721=235%:%
%:%722=236%:%
%:%723=236%:%
%:%724=237%:%
%:%726=239%:%
%:%728=240%:%
%:%729=240%:%
%:%730=241%:%
%:%731=242%:%
%:%732=243%:%
%:%733=244%:%
%:%734=245%:%
%:%737=246%:%
%:%741=246%:%
%:%742=246%:%
%:%743=247%:%
%:%744=247%:%
%:%745=248%:%
%:%746=248%:%
%:%747=249%:%
%:%748=249%:%
%:%749=249%:%
%:%750=249%:%
%:%751=249%:%
%:%752=249%:%
%:%753=250%:%
%:%754=250%:%
%:%755=251%:%
%:%756=251%:%
%:%757=252%:%
%:%758=252%:%
%:%759=252%:%
%:%760=252%:%
%:%761=252%:%
%:%762=253%:%
%:%763=253%:%
%:%764=253%:%
%:%765=253%:%
%:%766=253%:%
%:%767=254%:%
%:%768=254%:%
%:%769=255%:%
%:%770=255%:%
%:%771=255%:%
%:%772=255%:%
%:%773=255%:%
%:%774=256%:%
%:%784=258%:%
%:%786=259%:%
%:%787=259%:%
%:%788=260%:%
%:%789=261%:%
%:%790=262%:%
%:%791=263%:%
%:%794=264%:%
%:%798=264%:%
%:%799=264%:%
%:%800=265%:%
%:%801=265%:%
%:%802=266%:%
%:%803=266%:%
%:%804=267%:%
%:%805=267%:%
%:%806=268%:%
%:%807=268%:%
%:%808=269%:%
%:%809=269%:%
%:%810=270%:%
%:%811=270%:%
%:%812=271%:%
%:%813=271%:%
%:%814=272%:%
%:%815=273%:%
%:%816=273%:%
%:%817=274%:%
%:%818=274%:%
%:%819=275%:%
%:%820=275%:%
%:%821=275%:%
%:%822=275%:%
%:%823=275%:%
%:%824=276%:%
%:%825=276%:%
%:%826=277%:%
%:%827=277%:%
%:%828=278%:%
%:%829=278%:%
%:%830=279%:%
%:%831=280%:%
%:%832=280%:%
%:%833=281%:%
%:%834=281%:%
%:%835=282%:%
%:%836=282%:%
%:%837=283%:%
%:%838=283%:%
%:%839=283%:%
%:%840=283%:%
%:%841=284%:%
%:%842=284%:%
%:%843=285%:%
%:%844=285%:%
%:%845=285%:%
%:%846=285%:%
%:%847=286%:%
%:%848=286%:%
%:%849=287%:%
%:%850=287%:%
%:%851=287%:%
%:%852=288%:%
%:%853=288%:%
%:%854=289%:%
%:%855=289%:%
%:%856=289%:%
%:%857=290%:%
%:%858=290%:%
%:%859=291%:%
%:%860=291%:%
%:%861=292%:%
%:%862=292%:%
%:%863=293%:%
%:%864=293%:%
%:%865=294%:%
%:%866=294%:%
%:%867=295%:%
%:%868=295%:%
%:%869=295%:%
%:%870=296%:%
%:%871=296%:%
%:%872=297%:%
%:%878=297%:%
%:%881=298%:%
%:%882=299%:%
%:%883=299%:%
%:%886=300%:%
%:%890=300%:%
%:%891=300%:%
%:%892=300%:%
%:%897=300%:%
%:%900=301%:%
%:%901=302%:%
%:%902=302%:%
%:%905=303%:%
%:%909=303%:%
%:%910=303%:%
%:%919=305%:%
%:%921=306%:%
%:%922=306%:%
%:%923=307%:%
%:%924=308%:%
%:%925=309%:%
%:%926=310%:%
%:%933=311%:%
%:%934=311%:%
%:%935=312%:%
%:%936=312%:%
%:%937=313%:%
%:%938=314%:%
%:%939=314%:%
%:%940=315%:%
%:%941=315%:%
%:%942=316%:%
%:%943=316%:%
%:%944=317%:%
%:%945=317%:%
%:%946=318%:%
%:%947=318%:%
%:%948=319%:%
%:%949=319%:%
%:%952=322%:%
%:%953=323%:%
%:%954=323%:%
%:%955=324%:%
%:%956=324%:%
%:%957=325%:%
%:%958=325%:%
%:%959=326%:%
%:%960=327%:%
%:%961=327%:%
%:%962=327%:%
%:%963=328%:%
%:%964=329%:%
%:%965=329%:%
%:%966=330%:%
%:%967=330%:%
%:%968=331%:%
%:%969=331%:%
%:%970=332%:%
%:%971=332%:%
%:%972=333%:%
%:%973=333%:%
%:%974=334%:%
%:%975=334%:%
%:%976=335%:%
%:%977=335%:%
%:%978=336%:%
%:%979=336%:%
%:%980=337%:%
%:%981=337%:%
%:%982=337%:%
%:%983=337%:%
%:%984=338%:%
%:%985=338%:%
%:%986=338%:%
%:%987=338%:%
%:%988=339%:%
%:%989=339%:%
%:%990=340%:%
%:%991=340%:%
%:%992=341%:%
%:%993=341%:%
%:%994=341%:%
%:%995=342%:%
%:%996=342%:%
%:%997=343%:%
%:%998=343%:%
%:%999=344%:%
%:%1000=345%:%
%:%1001=345%:%
%:%1002=346%:%
%:%1003=346%:%
%:%1004=346%:%
%:%1005=346%:%
%:%1006=347%:%
%:%1007=347%:%
%:%1008=348%:%
%:%1009=348%:%
%:%1010=349%:%
%:%1011=349%:%
%:%1012=350%:%
%:%1013=350%:%
%:%1014=351%:%
%:%1015=352%:%
%:%1016=352%:%
%:%1017=353%:%
%:%1018=353%:%
%:%1019=354%:%
%:%1020=355%:%
%:%1021=355%:%
%:%1022=356%:%
%:%1023=356%:%
%:%1024=357%:%
%:%1025=357%:%
%:%1028=360%:%
%:%1029=361%:%
%:%1030=361%:%
%:%1031=361%:%
%:%1032=362%:%
%:%1033=362%:%
%:%1034=363%:%
%:%1035=364%:%
%:%1036=364%:%
%:%1037=365%:%
%:%1038=365%:%
%:%1039=366%:%
%:%1040=366%:%
%:%1041=366%:%
%:%1042=367%:%
%:%1043=367%:%
%:%1044=368%:%
%:%1045=369%:%
%:%1046=369%:%
%:%1047=369%:%
%:%1048=370%:%
%:%1049=370%:%
%:%1050=371%:%
%:%1051=371%:%
%:%1052=371%:%
%:%1053=371%:%
%:%1054=372%:%
%:%1055=372%:%
%:%1056=373%:%
%:%1057=373%:%
%:%1058=374%:%
%:%1059=374%:%
%:%1060=375%:%
%:%1061=375%:%
%:%1062=376%:%
%:%1063=376%:%
%:%1064=377%:%
%:%1065=377%:%
%:%1066=378%:%
%:%1067=379%:%
%:%1068=380%:%
%:%1069=381%:%
%:%1070=381%:%
%:%1071=382%:%
%:%1072=382%:%
%:%1073=383%:%
%:%1074=383%:%
%:%1075=383%:%
%:%1076=384%:%
%:%1082=384%:%
%:%1085=385%:%
%:%1086=386%:%
%:%1087=387%:%
%:%1088=387%:%
%:%1089=388%:%
%:%1092=389%:%
%:%1096=389%:%
%:%1097=389%:%
%:%1098=390%:%
%:%1099=390%:%
%:%1100=391%:%
%:%1101=392%:%
%:%1102=392%:%
%:%1103=393%:%
%:%1104=393%:%
%:%1105=394%:%
%:%1106=394%:%
%:%1107=395%:%
%:%1108=395%:%
%:%1109=396%:%
%:%1110=396%:%
%:%1111=397%:%
%:%1112=397%:%
%:%1113=398%:%
%:%1114=398%:%
%:%1115=398%:%
%:%1116=399%:%
%:%1117=399%:%
%:%1118=400%:%
%:%1119=401%:%
%:%1120=401%:%
%:%1121=402%:%
%:%1122=402%:%
%:%1123=403%:%
%:%1124=403%:%
%:%1125=404%:%
%:%1126=405%:%
%:%1127=405%:%
%:%1128=405%:%
%:%1129=406%:%
%:%1130=406%:%
%:%1131=407%:%
%:%1132=407%:%
%:%1133=407%:%
%:%1134=407%:%
%:%1135=408%:%
%:%1136=408%:%
%:%1137=409%:%
%:%1138=409%:%
%:%1139=410%:%
%:%1140=410%:%
%:%1141=411%:%
%:%1142=411%:%
%:%1143=412%:%
%:%1144=412%:%
%:%1145=413%:%
%:%1146=413%:%
%:%1147=413%:%
%:%1148=414%:%
%:%1149=414%:%
%:%1150=414%:%
%:%1151=415%:%
%:%1152=415%:%
%:%1153=416%:%
%:%1154=416%:%
%:%1155=416%:%
%:%1156=417%:%
%:%1157=417%:%
%:%1158=417%:%
%:%1159=418%:%
%:%1160=418%:%
%:%1161=418%:%
%:%1162=419%:%
%:%1163=419%:%
%:%1164=420%:%
%:%1165=420%:%
%:%1166=421%:%
%:%1167=421%:%
%:%1168=421%:%
%:%1169=422%:%
%:%1179=424%:%
%:%1181=425%:%
%:%1182=425%:%
%:%1183=426%:%
%:%1190=427%:%
%:%1191=427%:%
%:%1192=428%:%
%:%1193=428%:%
%:%1194=429%:%
%:%1195=429%:%
%:%1196=429%:%
%:%1197=429%:%
%:%1198=430%:%
%:%1199=430%:%
%:%1200=431%:%
%:%1201=431%:%
%:%1202=431%:%
%:%1203=432%:%
%:%1204=432%:%
%:%1205=433%:%
%:%1206=433%:%
%:%1207=434%:%
%:%1208=434%:%
%:%1209=435%:%
%:%1210=435%:%
%:%1211=436%:%
%:%1212=436%:%
%:%1213=437%:%
%:%1214=437%:%
%:%1215=437%:%
%:%1216=438%:%
%:%1217=438%:%
%:%1218=439%:%
%:%1219=439%:%
%:%1220=440%:%
%:%1221=440%:%
%:%1222=441%:%
%:%1223=441%:%
%:%1224=442%:%
%:%1225=442%:%
%:%1226=442%:%
%:%1227=442%:%
%:%1228=443%:%
%:%1229=443%:%
%:%1230=444%:%
%:%1231=444%:%
%:%1232=445%:%
%:%1233=445%:%
%:%1234=446%:%
%:%1235=446%:%
%:%1236=447%:%
%:%1237=447%:%
%:%1238=448%:%
%:%1239=448%:%
%:%1240=449%:%
%:%1241=449%:%
%:%1242=450%:%
%:%1243=450%:%
%:%1244=451%:%
%:%1245=451%:%
%:%1246=452%:%
%:%1247=452%:%
%:%1250=455%:%
%:%1251=456%:%
%:%1252=456%:%
%:%1253=457%:%
%:%1254=457%:%
%:%1255=457%:%
%:%1256=458%:%
%:%1257=458%:%
%:%1258=458%:%
%:%1259=459%:%
%:%1260=459%:%
%:%1261=459%:%
%:%1262=460%:%
%:%1263=460%:%
%:%1264=460%:%
%:%1265=461%:%
%:%1266=461%:%
%:%1267=461%:%
%:%1268=462%:%
%:%1269=462%:%
%:%1270=463%:%
%:%1271=464%:%
%:%1272=464%:%
%:%1273=465%:%
%:%1274=465%:%
%:%1275=466%:%
%:%1276=466%:%
%:%1277=467%:%
%:%1278=467%:%
%:%1279=468%:%
%:%1280=468%:%
%:%1281=469%:%
%:%1282=469%:%
%:%1283=470%:%
%:%1284=470%:%
%:%1285=471%:%
%:%1286=471%:%
%:%1287=472%:%
%:%1288=472%:%
%:%1289=472%:%
%:%1290=473%:%
%:%1291=473%:%
%:%1292=474%:%
%:%1293=474%:%
%:%1294=475%:%
%:%1295=475%:%
%:%1296=476%:%
%:%1297=476%:%
%:%1298=477%:%
%:%1299=477%:%
%:%1300=478%:%
%:%1301=478%:%
%:%1302=478%:%
%:%1303=479%:%
%:%1304=479%:%
%:%1305=480%:%
%:%1306=481%:%
%:%1307=481%:%
%:%1308=482%:%
%:%1309=482%:%
%:%1310=483%:%
%:%1311=483%:%
%:%1312=484%:%
%:%1313=484%:%
%:%1314=485%:%
%:%1315=485%:%
%:%1316=486%:%
%:%1317=486%:%
%:%1318=487%:%
%:%1319=487%:%
%:%1320=488%:%
%:%1321=488%:%
%:%1322=489%:%
%:%1323=489%:%
%:%1324=490%:%
%:%1325=490%:%
%:%1326=491%:%
%:%1327=491%:%
%:%1328=492%:%
%:%1338=494%:%
%:%1340=495%:%
%:%1341=495%:%
%:%1342=496%:%
%:%1343=496%:%
%:%1344=497%:%
%:%1345=498%:%
%:%1346=498%:%
%:%1347=499%:%
%:%1348=500%:%
%:%1349=500%:%
%:%1350=501%:%
%:%1351=502%:%
%:%1352=502%:%
%:%1355=503%:%
%:%1359=503%:%
%:%1360=503%:%
%:%1361=504%:%
%:%1362=504%:%
%:%1367=504%:%
%:%1370=505%:%
%:%1371=506%:%
%:%1372=506%:%
%:%1375=507%:%
%:%1379=507%:%
%:%1380=507%:%
%:%1381=508%:%
%:%1382=508%:%
%:%1387=508%:%
%:%1390=509%:%
%:%1391=510%:%
%:%1392=510%:%
%:%1393=511%:%
%:%1394=512%:%
%:%1397=513%:%
%:%1401=513%:%
%:%1402=513%:%
%:%1403=513%:%
%:%1408=513%:%
%:%1411=514%:%
%:%1412=515%:%
%:%1413=515%:%
%:%1414=516%:%
%:%1415=517%:%
%:%1416=518%:%
%:%1419=519%:%
%:%1423=519%:%
%:%1424=519%:%
%:%1425=519%:%
%:%1430=519%:%
%:%1433=520%:%
%:%1434=521%:%
%:%1435=521%:%
%:%1438=522%:%
%:%1442=522%:%
%:%1443=522%:%
%:%1444=523%:%
%:%1445=523%:%
%:%1446=524%:%
%:%1447=524%:%
%:%1448=525%:%
%:%1449=526%:%
%:%1454=526%:%
%:%1457=527%:%
%:%1458=527%:%
%:%1459=528%:%
%:%1460=529%:%
%:%1461=529%:%
%:%1462=530%:%
%:%1463=530%:%
%:%1464=531%:%
%:%1465=532%:%
%:%1466=532%:%
%:%1469=533%:%
%:%1473=533%:%
%:%1474=533%:%
%:%1475=534%:%
%:%1476=534%:%
%:%1481=534%:%
%:%1484=535%:%
%:%1485=535%:%
%:%1492=536%:%